<!doctype html>
<html lang="en">
	<head>
		<title>How Much Is a Pint</title>

		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<meta name="author" content="Martin Keys">
		<meta property="og:title" content="How Much Is a Pint"/>
		<meta name="og:description" content="How much is a good old British pint of beer" />
		<meta property="og:description" content="How much is a good old British pint of beer"/>
		<meta property="og:image" content="https://howmuchisapint.com/img/logo.png"/>
		<meta property="og:url" content=""https://howmuchisapint.com"/>
		<meta property="og:type" content="website" />

		<link rel="icon" type="image/png" href="img/pint.png"/>
	</head>
	<body>
 		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js"></script>
		<script src="js/moment.js"></script>


    	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
		<link href="css/custom.css" rel="stylesheet" type="text/css" >

		<span ng-app="app">
			<span ng-controller="appCtrl">
				<div class="p-3 text-light bg-dark">
					<div class="row">
						<div class="col">
							<img src="img/logo.png" class="img-fluid">
						</div>
					</div>
				</div>
				<div class="bg-image" style="background-size:cover;background-image:url('img/howmuchisapint_logo.png');">
			  		<div class="mask" style="min-height: 70.9vh;background-color:rgba(0, 0, 0, 0.8);">
						<div class="modal fade" id="frm_unhandled_error">
						 	<div class="modal-dialog">
						    	<div class="modal-content text-light bg-dark bg-opacity-75">
									<div class="modal-header">
							    		<h4 class="modal-title text-warning">Fatal Error</h4>
							    		<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
									</div>
									<div class="modal-body">
										<div class="p-2">
											<div class="alert alert-danger">
											  <strong>{{service_message}}</strong>
											</div>							
										</div>
										<div class="modal-footer">
											<button type="submit" class="btn btn-light" data-bs-dismiss="modal" ng-click="clean()">OK</button>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="p-3">
							<div class="shadow p-3 mb-4 text-light bg-dark bg-opacity-75">
								<div ng-if="!loggedin">
									<div ng-if="logginin">
										<div class="row">
											<center><span class="spinner-border spinner-border-md bg-dark text-warning"></span></center>
										</div>
									</div>
									<div ng-if="!logginin">
										<div class="row mt-3 mb-3">
											<div class="col">
												<span class="text-secondary">Be </span>
												<a href="#" class="link-info text-decoration-none" ng-click="login()">Annonymous
													<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
													  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
													</svg>
												</a>
												<span class="text-secondary"> or </span>
												<a href="#" class="link-info text-decoration-none" ng-click="signup()">Sign in
													<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
													  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
													</svg>
												</a>
												<span class="text-secondary">to track your own prices.</span>
											</div>
										</div>
									</div>
								</div>
								<div ng-if="loggedin">
									<div class="row mt-0" >
										<div class="col">
											<h4>
												<span class="text-warning">The latest pint prices in</span>
												<span ng-show="working_head_stats" class="spinner-border spinner-border-sm text-warning ms-1 me-1"></span>
												<span ng-show="!working_head_stats" class="text-warning">{{home_country}} </span>
											</h4>
										</div>
									</div>
									<div ng:repeat="r in sorted_head_stat_latest = (head_stat_latest | orderBy: 'date':true)">
										<div ng:if="$index == 0 || r.date != sorted_head_stat_latest[$index - 1].date">
											<div class="row mt-2" >
												<div class="col">
													<span>{{get_date_display(r.date)}}</span>
												</div>
											</div>
										</div>
										<div class="row mt-0" >
											<div class="col">
												<span class="text-info">{{r.pub.name}} <span class="text-muted"> {{r.pub.type}} </span> {{r.beer.name}}<span class="text-muted"> {{r.beer.type}} </span> {{home_ccy_symbol}}{{get_number_display(r.price, 2)}}</span>
											</div>
										</div>
									</div>
									<div class="row mt-4" >
										<div class="col">
											<h4>
												<span ng-show="working_head_stats" class="spinner-border spinner-border-sm text-warning ms-1 me-1"></span>
												<span ng-show="!working_head_stats" class="text-warning">{{get_number_display(head_stat_tot, 0)}} ({{get_number_display(head_stat_tot2, 0)}} recent)</span>
												<span class="text-warning">pint prices in pubs in </span>
												<span ng-show="working_head_stats" class="spinner-border spinner-border-sm text-warning ms-1 me-1"></span>
												<span ng-show="!working_head_stats">
													<span ng-show="home_town.length==0 && home_city.length>0" class="text-warning">{{home_city}}<span class="text-muted">, {{home_country}}</span></span>
													<span ng-show="home_city.length>0 && home_town.length>0" class="text-warning">{{home_town}}<span class="text-muted">, {{home_city}}, {{home_country}}</span></span>
													<span ng-show="home_town.length==0 && home_city.length==0" class="text-warning">{{home_country}} </span>
												</span>
											</h4>
										</div>
									</div>
									<div class="row mt-2" >
										<div class="col">
											<span>{{head_stat_avgs}}</span>
										</div>
									</div>
									<div class="row mt-4">
										<div class="col">
											<h4><span class="text-warning">Pint price agent</span></h4>
										</div>
									</div>
									<div class="row mt-1">
										<div class="col">
											<label class="form-label">Ask about pint prices or tell me about a new one<!--Ask me about pint prices or tell me about a new one-->
												<a href="#" class="link-info text-decoration-none" data-bs-toggle="collapse" data-bs-target="#agent_info">
													<span class="ms-2">
														<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-square text-secondary" viewBox="0 0 16 16">
														  <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
														  <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
														</svg>
													</span>
												</a>
											</span>
											<span id="agent_info" class="collapse text-secondary ms-1">Don't get offended if this does not work... the command may actually have worked although it doesn't look like it (the request may have timed out), so check before trying again, it quite likely may respond with something stupid, so trying again might work, and finally the money may have run out!</span>
										</div>
									</div>
									<div class="row mt-0">
										<div class="col">
											<textarea class="form-control bg-dark text-light" ng-model="frm_agent.command" placeholder="Say things like 'How much is the most expensive pint of Guinness in Sheffield in the past year?' or 'Guinness is a fiver at the Lescar in Sheffield'" rows="2" required></textarea>
										</div>
									</div>
									<div class="row mt-3">
										<div class="col">
											<button type="button" class="btn-light btn-sm" ng-click="agent_go()">Hit me</button>
										</div>
									</div>
									<div class="row mt-3 mb-2">
										<div class="col" ng-show="working_agent">
											<span class="spinner-border spinner-border-sm text-warning ms-1 me-1"></span>
										</div>
										<div class="col" ng-show="!working_agent && agent_err.length>0">
											<span class="text-danger">{{agent_err}}</span>
										</div>
										<div class="col" ng-show="!working_agent && agent_info.length>0">
											<span class="text-info">{{agent_info}}</span>
										</div>
									</div>
								</div>
							</div>
							<div ng-if="loggedin">
								<div class="shadow p-3 mb-4 text-light bg-dark bg-opacity-75">
									<div class="row mt-0">
										<h4><a href="#" class="link-info text-decoration-none text-warning" data-bs-toggle="collapse" data-bs-target="#data_beers">Beers
											<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-expand" viewBox="0 0 16 16">
											  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8zM7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10z"/>
											</svg>
										</a><h4>
									</div>
									<div id="data_beers" class="collapse">
										<div class="row mt-1">
											<div class="col">
												<select ng-options="beertype.name as beertype.name for beertype in (frm_beer.type_list | orderBy: 'name')" class="form-control bg-dark text-light"" ng-model="frm_beer.type"></select>
												<input class="form-control bg-dark text-light" type="text" ng-model="frm_beer.name" placeholder="Name" required>
											</div>
										</div>
										<div class="row mt-3">
											<div class="col">
												<button type="button" class="btn-light btn-sm" ng-click="clear_beers_sel()">Clear</button>
												<button type="button" class="btn-light btn-sm" ng-click="get_beers()">List</button>
												<button type="button" class="btn-light btn-sm" ng-click="add_beer()">Add</button>
											</div>
										</div>
										<div class="row mt-3 mb-2">
											<div class="col" ng-show="working_get_beers">
												<span class="spinner-border spinner-border-sm text-warning ms-1 me-1"></span>
											</div>
											<div class="col" ng-show="!working_get_beers && get_beers_err.length>0">
												<span class="text-danger">{{get_beers_err}}</span>
											</div>
											<div class="col" ng-show="!working_get_beers && get_beers_info.length>0">
												<span class="text-light">{{get_beers_info}}</span>
											</div>
											<div class="col" ng-show="working_add_beer">
												<span class="spinner-border spinner-border-sm text-warning ms-1 me-1"></span>
											</div>
											<div class="col" ng-show="!working_add_beer && add_beer_err.length>0">
												<span class="text-danger">{{add_beer_err}}</span>
											</div>
											<div class="col" ng-show="!working_add_beer && add_beer_info.length>0">
												<span class="text-info">{{add_beer_info}}</span>
											</div>
										</div>
										<div ng-show="!working_get_beers && beer_data.beer.length>0">
											<div ng:repeat="r in sorted_beer_data = (beer_data.beer | orderBy: ['\u0022display-name\u0022'])">
												<div class="row mt-0">
													<div class="col">
													</div>
														<span class="text-info">{{r.name}}</span>
												</div>
											</div>
										</div>
									</div>
									<div class="row mt-4">
										<h4><a href="#" class="link-info text-decoration-none text-warning" data-bs-toggle="collapse" data-bs-target="#data_pubs">Pubs
											<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-expand" viewBox="0 0 16 16">
											  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8zM7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10z"/>
											</svg>
										</a><h4>
									</div>
									<div id="data_pubs" class="collapse">
										<div class="row mt-1">
											<div class="col">
												<select ng-options="pubtype.name as pubtype.name for pubtype in (frm_pub.type_list | orderBy: 'name')" class="form-control bg-dark text-light"" ng-model="frm_pub.type"></select>
												<input class="form-control bg-dark text-light"" type="text" ng-model="frm_pub.name" placeholder="Name"/>
											</div>
										</div>
										<div class="row mt-3">
											<div class="col">
												<select ng-options="ctry.name as ctry.name for ctry in (country_list | orderBy: 'name')" class="form-control bg-dark text-light"" ng-model="frm_pub.country"></select>
												<input class="form-control bg-dark text-light"" type="text" ng-model="frm_pub.city" placeholder="City"/>
												<input class="form-control bg-dark text-light"" type="text" ng-model="frm_pub.town" placeholder="Town"/>
											</div>
										</div>
										<div class="row mt-3">
											<div class="col">
												<button type="button" class="btn-light btn-sm" ng-click="clear_pubs_sel()">Clear</button>
												<button type="button" class="btn-light btn-sm" ng-click="get_pubs()">List</button>
											</div>
										</div>
										<div class="row mt-3 mb-2">
											<div class="col" ng-show="working_get_pubs">
												<span class="spinner-border spinner-border-sm text-warning ms-1 me-1"></span>
											</div>
											<div class="col" ng-show="!working_get_pubs && get_pubs_err.length>0">
												<span class="text-danger">{{get_pubs_err}}</span>
											</div>
											<div class="col" ng-show="!working_get_pubs && get_pubs_info.length>0">
												<span class="text-light">{{get_pubs_info}}</span>
											</div>
										</div>
										<div ng-show="!working_get_pubs && pub_data.pub.length>0">
											<div ng:repeat="r in sorted_pub_data = (pub_data.pub | orderBy: ['\u0022display-name\u0022'])">
												<div data-bs-toggle="collapse" data-bs-target="#{{'pub_' + $index}}">
													<div class="row mt-0">
														<div class="col">
															<span class="text-info">{{r.name}}</span-->
																<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-expand" viewBox="0 0 16 16">
																  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8zM7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10z"/>
																</svg>
															</span>
														</div>
													</div>
												</div>
												<div id="{{'pub_' + $index}}" class="row mt-0 collapse">
													<div class="col">
														<span class="text-muted">{{r.type}} in {{r.town}}, {{r.city}}, {{r.country}}</span>
													</div>
												</div>
											</div>
											<div class="row mt-2">
												<div class="col">
												</div>
											</div>
										</div>
										<div class="row mt-3">
											<div class="col">
												<input class="form-control bg-dark text-light"" type="text" ng-model="frm_pub.pc" placeholder="Post Code"/>
											</div>
										</div>
										<div class="row mt-3">
											<div class="col">
												<button type="button" class="btn-light btn-sm" ng-click="add_pub()">Add</button>
											</div>
										</div>
										<div class="row mt-3 mb-2">
											<div class="col" ng-show="working_add_pub">
												<span class="spinner-border spinner-border-sm text-warning ms-1 me-1"></span>
											</div>
											<div class="col" ng-show="!working_add_pub && add_pub_err.length>0">
												<span class="text-danger">{{add_pub_err}}</span>
											</div>
											<div class="col" ng-show="!working_add_pub && add_pub_info.length>0">
												<span class="text-info">{{add_pub_info}}</span>
											</div>
										</div>
									</div>
									<div class="row mt-4">
										<h4><a href="#" class="link-info text-decoration-none text-warning" data-bs-toggle="collapse" data-bs-target="#data_prices">Pint Prices
											<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-expand" viewBox="0 0 16 16">
											  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8zM7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10z"/>
											</svg>
										</a><h4>
									</div>
									<div id="data_prices" class="collapse">
										<div class="row mt-1">
											<div class="col">
												<select class="form-control bg-dark text-light" ng-change="upd_prices_pub_country()" ng-model="frm_prices.pub_country" >
													<option ng-repeat="ctry in sorted = (country_list | orderBy: 'name')" value="{{ctry.name}}">{{ctry.name}}</option>
												</select>
												<select ng-options="pubcity.name as pubcity.name for pubcity in (frm_prices.pub_city_list | orderBy:'name')" class="form-control bg-dark text-light" ng-change="upd_prices_pub_city()" ng-model="frm_prices.pub_city" >
													<option value=""> -- City  -- </option>
												</select>
												<select ng-options="pubtown.name as pubtown.name for pubtown in (frm_prices.pub_town_list | orderBy:'name')" class="form-control bg-dark text-light	" ng-change="upd_prices_pub_town()" ng-model="frm_prices.pub_town" >
													<option value=""> -- Town  -- </option>
												</select>
											</div>
										</div>
										<div class="row mt-3">
											<div class="col">
												<select ng-options="pubtype.name as pubtype.name for pubtype in (frm_prices.pub_type_list| orderBy:'name')" class="form-control bg-dark text-light" ng-change="upd_prices_pub_type()" ng-model="frm_prices.pub_type" >
													<option value=""> -- Type  -- </option>
												</select>
												<select ng-options="pub as pub.name for pub in (frm_prices.pub_name_list | orderBy:['\u0022display-name\u0022'])" class="form-control bg-dark text-light" ng-change="upd_prices_pub_name()" ng-model="frm_prices.pub_name" >
													<option value=""> -- Pub  -- </option>
												</select>
											</div>
										</div>
										<div class="row mt-3">
											<div class="col">
												<select ng-options="beertype.name as beertype.name for beertype in (frm_prices.beer_type_list| orderBy:'name')" class="form-control bg-dark text-light" ng-change="upd_prices_beer_type()" ng-model="frm_prices.beer_type" >
													<option value=""> -- Type  -- </option>
												</select>
												<select ng-options="beer as beer.name for beer in (frm_prices.beer_name_list | orderBy:['name'])" class="form-control bg-dark text-light" ng-change="upd_prices_beer_name()" ng-model="frm_prices.beer_name" >
													<option value=""> -- Beer  -- </option>
												</select>
											</div>
										</div>
										<div class="row mt-3">
											<div class="col">
												<select ng-options="ccy.code as ccy.code + ' - ' + ccy.name for ccy in (frm_prices.ccy_list | orderBy: ['code'])" class="form-control bg-dark text-light" ng-change="upd_prices_display_ccy()" ng-model="frm_prices.display_ccy" >
												</select>
									  		</div>
										</div>
										<div class="row mt-3">
											<div class="col">
												<button type="button" class="btn-light btn-sm" ng-click="clear_prices_sel()">Clear</button>
												<button type="button" class="btn-light btn-sm" ng-click="get_prices()">List</button>
												<button type="button" class="btn-light btn-sm" ng-click="get_avg_prices()">Summarise</button>
											</div>
										</div>
										<div class="row mt-3 mb-2">
											<div class="col" ng-show="working_get_prices">
												<span class="spinner-border spinner-border-sm text-warning ms-1 me-1"></span>
											</div>
											<div class="col" ng-show="!working_get_prices && get_prices_err.length>0">
												<span class="text-danger">{{get_prices_err}}</span>
											</div>
											<div class="col" ng-show="!working_get_prices && get_prices_info.length>0">
												<span class="text-light">{{get_prices_info}}</span>
											</div>
										</div>
										<div ng-show="!working_get_prices && price_data['beer-price'].length>0">
											<div ng:repeat="r in sorted_price_data = (price_data['beer-price'] | orderBy: 'date':true)">
												<div ng:if="$index == 0 || r.date != sorted_price_data[$index - 1].date">
													<div class="row mt-2">
														<div class="col">
															<span>{{get_date_display(r.date)}}</span>
														</div>
													</div>
												</div>
												<div data-bs-toggle="collapse" data-bs-target="#{{'price_' + $index}}">
													<div class="row mt-0">
														<div class="col">
															<span class="text-info">{{r.beer.name}} {{frm_prices.display_ccy_symbol}}{{get_number_display(r.price / frm_prices.display_fxrate, 2)}}
																<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-expand" viewBox="0 0 16 16">
																  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8zM7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10z"/>
																</svg>
															</span>
														</div>
													</div>
												</div>
												<div id="{{'price_' + $index}}" class="row mt-0 collapse">
													<div class="col">
														<span class="text-muted">{{r.pub.type}} {{r.pub.name}}, {{r.pub.town}}, {{r.pub.city}}, {{r.pub.country}}</span>
													</div>
												</div>
											</div>
										</div>
										<div ng-show="!working_get_prices && price_stat_data['beer-price-stats'].length>0">
											<div ng:repeat="r in sorted_price_stat_data = price_stat_data['beer-price-stats'] | orderBy: ['pub.type','beer.type','pub']">
												<div data-bs-toggle="collapse" data-bs-target="#{{'pricestat1_' + $index}}">
													<div class="row mt-0">
														<div class="col">
															<span ng-show="r['recent-count']>0" class="text-info">{{r.beer.type}} in {{r.pub.type}}s is {{frm_prices.display_ccy_symbol}}{{get_number_display(r['recent-avg-price'] / frm_prices.display_fxrate, 2)}}
																<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-expand" viewBox="0 0 16 16">
																  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8zM7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10z"/>
																</svg>
															</span>
														</div>
													</div>
												</div>
												<div id="{{'pricestat1_' + $index}}" class="collapse">
													<div ng:repeat="y in sorted_price_stat_data_year = r['by-year'] | orderBy: ['year']:true">
														<div class="row mt-0">
															<div class="col">
																<span class="text-muted">{{frm_prices.display_ccy_symbol}}{{get_number_display(y['avg-price'] / frm_prices.display_fxrate, 2)}} {{get_number_display(y.count,0)}} prices {{get_years_ago_display(y.year)}}</span>
															</div>
														</div>
													</div>
												</div>
											</div>
											<div ng:repeat="r in sorted_price_stat_data = price_stat_data['beer-price-stats'] | orderBy: ['pub.type','beer.type','pub']">
												<div data-bs-toggle="collapse" data-bs-target="#{{'pricestat2_' + $index}}">
													<div class="row mt-0">
														<div class="col">
															<span ng-show="r['recent-count']==0" class="text-info">{{r.beer.type}} in {{r.pub.type}}s has no recent prices
																<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-expand" viewBox="0 0 16 16">
																  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8zM7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10z"/>
																</svg>
															</span>
														</div>
													</div>
												</div>
												<div id="{{'pricestat2_' + $index}}" class="collapse">
													<div ng:repeat="y in sorted_price_stat_data_year = r['by-year'] | orderBy: ['year']:true">
														<div class="row mt-0">
															<div class="col">
																<span class="text-muted">{{frm_prices.display_ccy_symbol}}{{get_number_display(y['avg-price'] / frm_prices.display_fxrate, 2)}} {{get_number_display(y.count,0)}} prices {{get_years_ago_display(y.year)}}</span>
															</div>
														</div>
													</div>
												</div>
											</div>
											<div class="row mt-2">
												<div class="col">
												</div>
											</div>
										</div>
										<div class="row mt-3">
											<div class="col">
												<input class="form-control bg-dark text-light" type="number" ng-model="frm_prices.amount" min="0" step="0.01" placeholder="Price"/>
											</div>
											<div class="col">
												<select ng-options="ccy.code as ccy.code + ' - ' + ccy.name for ccy in (frm_prices.ccy_list | orderBy: ['code'])" class="form-control bg-dark text-light" ng-change="" ng-model="frm_prices.ccy" disabled>
												</select>
											</div>	
										</div>
										<div class="row mt-3">
											<div class="col">
												<button type="button" class="btn-light btn-sm" ng-click="add_price()">Add</button>
											</div>
										</div>
										<div class="row mt-3 mb-2">
											<div class="col" ng-show="working_add_price">
												<span class="spinner-border spinner-border-sm text-warning ms-1 me-1"></span>
											</div>
											<div class="col" ng-show="!working_add_price && add_price_err.length>0">
												<span class="text-danger">{{add_price_err}}</span>
											</div>
											<div class="col" ng-show="!working_add_price && add_price_info.length>0">
												<span class="text-info">{{add_price_info}}</span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="mask" style="background-color:rgba(0, 0, 0, 0.8);">
							<div ng-if="use_cookies">
								<div class="p-5">
									<div class="row mt-3">
									</div>
								</div>
							</div>
							<div ng-if="!use_cookies" class="text-center">
								<div class="p-4">
									<div class="p-2 ms-5 me-5 bg-light">
									<span class="text-dark"><b>Do you like cookies?</b></span> &#x1F36A; <span class="text-dark ms-2">Cookies are in use to ensure the best experience</span>
									<button type="button" class="btn btn-md btn-info ms-2" ng-click="accept_cookies()">I agree</button>
									<!--a class="link-info text-decoration-none ms-1" href="https://cookiesandyou.com/" target="_blank">Learn more
										<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
										  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
										</svg>
									</a-->
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="p-3 text-light bg-dark">
				<div class="row mb-1">
					<div class="col">
						<span class="float-start"><a href="mailto:hello@conceptintegral.com" class="link-secondary text-decoration-none">hello@howmuchisapint.com</a></span>
					</div>
					<div class="col">
						<span class="float-end text-secondary">&copy; 2026 <a href="https://www.howmuchisapint.com" class="link-secondary text-decoration-none">Concept Integral</a></span>
					</div>
				</div>
			</span>
		</span>
		<script>
			var app = angular.module('app', []);
			app.controller('appCtrl', function($scope, $http, $location, $window) 
			{
				$scope.service_path = "https://api.howmuchisapint.com/service";

				$scope.clean = function()
				{
					$scope.loggedin = false;
					$scope.logginin = false
					$scope.user = 'guest';
					$scope.service_message = "";
					
					$scope.token = null;
					
					$scope.head_stat_tot = 0;
					$scope.head_stat_tot2 = 0;
					$scope.head_stat_avgs = '';
					$scope.head_stat_latest = '';
					$scope.working_head_stats = false

					$scope.home_country = 'United Kingdom';
					$scope.home_city = '';
					$scope.home_town = '';
					$scope.home_pc = '';
					
					country_list = [];
					
					$scope.frm_agent = {'command':''};
					$scope.agent_err = '';
					$scope.agent_info = '';
					$scope.working_agent = false;

					$scope.frm_beer = {'type':'','name':'','type_list':[]};
		
					$scope.frm_pub = {'type':'','name':'','country':'','city':'','town':'','pc':'','type_list':[]};
					$scope.frm_pub.name = '';
					$scope.frm_pub.country = $scope.home_country 
					$scope.frm_pub.city = '';
					$scope.frm_pub.town = '';
					$scope.frm_pub.pc = '';
		

					$scope.add_pub_err = '';
					$scope.add_pub_info = '';
					$scope.get_pubs_err = '';
					$scope.get_pubs_info = '';
					$scope.working_get_pubs = false;
					$scope.working_add_pub = false;

					$scope.add_beer_err = '';
					$scope.add_beer_info = '';
					$scope.get_beers_err = '';
					$scope.get_beers_info = '';
					$scope.working_add_beer = false;
					$scope.working_get_beers = false;

					$scope.frm_prices = {'amount':'','beer_type':'','beer_name':'','pub_type':'','pub_name':'','pub_country':'','pub_city':'','pub_town':'','pub_pc':'','display_ccy':'','display_ccy_symbol':'','display_fxrate':'','ccy':'','ccy_symbol':'','pub_type_list':[],'beer_type_list':[], 'ccy_list':[]};
					$scope.frm_prices.amount = 0.00;
					$scope.frm_prices.pub_country = $scope.home_country;
					$scope.frm_prices.pub_town = null;
					$scope.frm_prices.pub_pc = null;
					$scope.frm_prices.pub_city = null;
					$scope.frm_prices.pub_type = null;
					$scope.frm_prices.pub_name = null;
					$scope.frm_prices.beer_type = null;
					$scope.frm_prices.beer_name = null;

					$scope.add_price_err = '';
					$scope.add_price_info = '';
					$scope.get_prices_err = '';
					$scope.get_prices_info = '';
					$scope.working_get_prices = false;
					$scope.working_add_price = false;
				}
				$scope.clean();

				$scope.http_success = function(resp, success_action, inv_action, err_action, retry_action)
				{
					if (resp.data["ok"])
					{
						success_action(resp);
					}
					else
					{
						$scope.http_fail(resp, inv_action, err_action, retry_action);
					}		
				}
				$scope.http_fail = function(resp, inv_action, err_action, retry_action)
				{
					if (resp.data != undefined && "ok" in resp.data)
					{
						$scope.service_message = resp.data["message"];
					}
					else
					{
						$scope.service_message = (resp.statusText=="" ? "Uknown error" : resp.statusText) + " [" + resp.status + "]";
					}
					if (resp.status == 403 && $scope.token != "")
					{
						$http.get($scope.service_path + '/authenticate?uid=' + $scope.user).then(
							function(resp)
							{
								$scope.token = resp.data.token 
								$scope.token_exp = resp.data.expiry 
								console.log('token is ' + $scope.token);
								if (retry_action != undefined)
								{	
									retry_action();
								}
							},
							function(resp)
							{
								$scope.clean()
								$scope.login()
							});
					}
					else if (resp.status > 399 && resp.status < 500 && inv_action != undefined)
					{
						inv_action(resp);
					}
					else if (err_action != undefined)
					{
						err_action(resp);
					}
					else
					{
						$scope.clean()
						$scope.login()
					}
				}
				$scope.http_get = function(url, params, success_action, invalid_action, error_action)
				{
					$scope.service_message = "";
					req_url = url
					if (params != undefined && params.length > 0)
					{
						req_url = req_url + '?' + params;
					}
					var retry_action = function (retry_url) {
													return function(){console.log("GET:" + retry_url + (params.length > 0 ? '&' : '?') + 'token=' + $scope.token); $http.get(retry_url + (params.length > 0 ? '&' : '?') + 'token=' + $scope.token).then(function(resp){$scope.http_success(resp, success_action, invalid_action, error_action)},function(resp){$scope.http_fail(resp, invalid_action, error_action)})};
															}(req_url);
					console.log("GET:" + req_url + (params.length > 0 ? '&' : '?') + 'token=' + $scope.token)
					$http.get(req_url + (params.length > 0 ? '&' : '?') + 'token=' + $scope.token).then(function(resp){$scope.http_success(resp, success_action, invalid_action, error_action, retry_action)}, function(resp){$scope.http_fail(resp, invalid_action, error_action, retry_action)});
				}
				$scope.http_post = function(url, msg, success_action, invalid_action, error_action)
				{
					$scope.service_message = "";
					var retry_action = function (retry_url, retry_msg) {
													return function(){retry_msg['token'] = $scope.token; retry_post_msg = JSON.stringify(retry_msg); console.log("post:" + retry_url + ':' + retry_post_msg); $http.post(retry_url, retry_msg).then(function(resp){$scope.http_success(resp, success_action, invalid_action, error_action)}, function(resp){$scope.http_fail(resp, invalid_action, error_action)})};
															}(url, msg);
					msg['token'] = $scope.token
					post_msg = JSON.stringify(msg)
					console.log("post:" + url + ':' + post_msg)
					$http.post(url, post_msg).then(function(resp){$scope.http_success(resp, success_action, invalid_action, error_action, retry_action)}, function(resp){$scope.http_fail(resp, invalid_action, error_action, retry_action)});
				}
				$scope.home_country = 'United Kingdom';
				$scope.home_city = '';
				$scope.home_town = '';
				$scope.home_pc = '';
				$scope.home_ccy = '';				
				$scope.home_ccy_symbol = '';				
				$http.get('https://api.ipgeolocation.io/getip?apiKey=7109be59140c4b538dfc3bacb50a241a').then(
				function(response)
				{
					console.log('ip is ' + response.data.ip);
					$http.get('https://api.ipgeolocation.io/ipgeo?ip=' + response.data.ip + '&apiKey=7109be59140c4b538dfc3bacb50a241a').then(
						function(response)
						{
							//$scope.user = 'guest-' + response.data.ip
							$scope.home_country = response.data.country_name;
							$scope.home_town = response.data.city;
							$scope.home_city = response.data.district;
							$scope.home_pc = response.data.zipcode;
							console.log($scope.home_country+ ','+$scope.home_city+','+$scope.home_town+','+$scope.home_pc);
						},function(response){}
					);
				})

				$scope.accept_cookies = function()
				{
					$scope.use_cookies = true;
					d = new Date();
		  			d.setTime(d.getTime() + (100*24*60*60*1000));
					document.cookie = "cookies=true;expires="+d.toUTCString()+";path=/";
				}
				$scope.read_cookie = function(cname) 
				{
					name = cname + "=";
					cookie = decodeURIComponent(document.cookie);
					ca = cookie.split(';');
					for(i = 0; i < ca.length; i++) 
					{
						c = ca[i];
						while (c.charAt(0) == ' ') 
						{
							c = c.substring(1);
						}
					   	if (c.indexOf(name) == 0) 
						{
					      return c.substring(name.length, c.length);
					   	}
					}
					return "";
				}
				$scope.check_cookies = function()
				{
					$scope.use_cookies=$scope.read_cookie("cookies")=="true";
					if ($scope.use_cookies)
					{
						//$scope.frm_login.id=$scope.read_cookie("uid");
						//if ($scope.frm_login.id!="")
						//{
						//	$scope.frm_login.remember=true;
						//}
					}
				}
				$scope.check_cookies();

			    $scope.upd_prices_pub_country = function()
			    {
					$scope.price_stat_data = '';
					$scope.price_data = '';
					$scope.frm_prices.pub_city = null;
					$scope.frm_prices.pub_town = null;
					$scope.frm_prices.pub_type = null;
					$scope.frm_prices.pub_name = null;
					$scope.frm_prices.pub_city_list = [];
					$scope.frm_prices.pub_town_list = [];
					$scope.frm_prices.pub_type_list = [];
					if ($scope.frm_prices.pub_country != null)
					{
						for (ctry in $scope.country_list)
						{
							if ($scope.country_list[ctry].name == $scope.frm_prices.pub_country)
							{
								$scope.frm_prices.ccy = $scope.country_list[ctry].ccy;
								$scope.frm_prices.display_ccy = $scope.country_list[ctry].ccy;
							}
						}
						$scope.upd_prices_display_ccy();

						url = $scope.service_path + '/pub';
						$scope.http_get(url, '', function(response)
							{
								$scope.frm_prices.pub_city_list = [];
								$scope.frm_prices.pub_city = null;
								for (p in response.data.pub)
								{
									pub = response.data.pub[p]
									if ((pub.town == $scope.frm_prices.pub_town || $scope.frm_prices.pub_town == null) && (pub.city == $scope.frm_prices.pub_city || $scope.frm_prices.pub_city == null) && pub.country == $scope.frm_prices.pub_country)
									{ 
										var ex = false;
										for (p2 in $scope.frm_prices.pub_type_list)
										{
											ex = ex || $scope.frm_prices.pub_type_list[p2].name == pub.type;
										}
										if (!ex)
										{
											$scope.frm_prices.pub_type_list.push({'name':pub.type});
										}
									}
									if (response.data.pub[p].country == $scope.frm_prices.pub_country)
									{ 
										var ex = false;
										for (p2 in $scope.frm_prices.pub_city_list)
										{
											ex = ex || $scope.frm_prices.pub_city_list[p2].name == pub.city;
										}
										if (!ex)
										{
											$scope.frm_prices.pub_city_list.push({'name':pub.city});
										}
									}
								}
								if ($scope.frm_prices.pub_city_list.length == 1)
								{
									$scope.frm_prices.pub_city = $scope.frm_prices.pub_city_list[0].city;
								}
								$scope.upd_prices_pub_city();
								if ($scope.frm_prices.pub_type_list.length == 1)
								{
									$scope.frm_prices.pub_type = $scope.frm_prices.pub_type_list[0].name;
								}
								$scope.upd_prices_pub_type();
							});
					}
				}
			    $scope.upd_prices_pub_city = function()
			    {
					$scope.price_stat_data = '';
					$scope.price_data = '';
					$scope.frm_prices.pub_town = null;
					$scope.frm_prices.pub_pc = null;
					$scope.frm_prices.pub_type = null;
					$scope.frm_prices.pub_name = null;
					$scope.frm_prices.pub_town_list = [];
					if ($scope.frm_prices.pub_city != null)
					{
						url = $scope.service_path + '/pub';
						$scope.http_get(url, '', function(response)
							{
								$scope.frm_prices.pub_town = null;
								$scope.frm_prices.pub_town_list = [];
								for (p in response.data.pub)
								{
									pub = response.data.pub[p]
									if (pub.city == $scope.frm_prices.pub_city && pub.country == $scope.frm_prices.pub_country)
									{ 
										var ex = false;
										for (p2 in $scope.frm_prices.pub_town_list)
										{
											ex = ex || $scope.frm_prices.pub_town_list[p2].name == pub.town;
										}
										if (!ex)
										{
											$scope.frm_prices.pub_town_list.push({'name':pub.town});
										}
									}
								}
								if ($scope.frm_prices.pub_town_list.length == 1)
								{
									$scope.frm_prices.pub_town = $scope.frm_prices.pub_town_list[0].name;
								}
								$scope.upd_prices_pub_town();
							});
					}
				} 
			    $scope.upd_prices_pub_town = function()
			    {
					$scope.price_stat_data = '';
					$scope.price_data = '';
					$scope.frm_prices.pub_type = null;
					$scope.upd_prices_pub_type();
			    } 
			    $scope.upd_prices_pub_type = function()
			    {
					$scope.price_stat_data = '';
					$scope.price_data = '';
					$scope.frm_prices.pub_name = null;
					$scope.frm_prices.pub_name_list = [];
					if ($scope.frm_prices.pub_type != null)
					{
						url = $scope.service_path + '/pub';
						$scope.http_get(url, '', function(response)
							{
								$scope.frm_prices.pub_name = null;
								$scope.frm_prices.pub_name_list = [];
								for (p in response.data.pub)
								{
									pub = response.data.pub[p]
									if (pub.type == $scope.frm_prices.pub_type && (pub.town == $scope.frm_prices.pub_town || $scope.frm_prices.pub_town == null) && (pub.city == $scope.frm_prices.pub_city || $scope.frm_prices.pub_city == null) && pub.country == $scope.frm_prices.pub_country)
									{ 
										$scope.frm_prices.pub_name_list.push({'display-name':pub['display-name'], 'name':pub['name'], 'id':pub.audit.id});
									}
								}
								if ($scope.frm_prices.pub_name_list.length == 1)
								{
									$scope.frm_prices.pub_name = $scope.frm_prices.pub_name_list[0];
								}
							});
					}
			    } 
			    $scope.upd_prices_pub_name = function()
			    {
					$scope.price_stat_data = '';
					$scope.price_data = '';
			    }
			    $scope.upd_prices_beer_type = function()
			    {
					$scope.price_stat_data = '';
					$scope.price_data = '';
					$scope.frm_prices.beer_name_list = [];
					$scope.frm_prices.beer_name = null;
					if ($scope.frm_prices.beer_type != null)
					{
						url = $scope.service_path + '/beer';
						$scope.http_get(url, '', function(response)
							{
								$scope.frm_prices.beer_name_list = [];
								$scope.frm_prices.beer_name = null;
								for (p in response.data.beer)
								{
									beer = response.data.beer[p]
									if (beer.type == $scope.frm_prices.beer_type)
									{ 
										$scope.frm_prices.beer_name_list.push({'name':beer.name, 'id':beer.audit.id});
									}
								}
								if ($scope.frm_prices.beer_name_list.length == 1)
								{
									$scope.frm_prices.beer_name = $scope.frm_prices.beer_name_list[0];
								}
							});
					}
			    } 
			    $scope.upd_prices_beer_name = function()
			    {
					$scope.price_stat_data = '';
					$scope.price_data = '';
			    }
			    $scope.upd_prices_display_ccy = function()
			    {
			    	if ($scope.frm_prices.display_ccy != null)
			    	{
						$scope.frm_prices.display_fxrate = 1;
						if ($scope.frm_prices.ccy != $scope.frm_prices.display_ccy)
						{
							$scope.frm_prices.display_fxrate = 0;
							url = $scope.service_path + '/fxrate/' + $scope.frm_prices.ccy + $scope.frm_prices.display_ccy;
							$scope.http_get(url, 'latest=Y', function(response)
								{
									if (response.data['fx-rate'].length > 0)
									{
										$scope.frm_prices.display_fxrate = response.data['fx-rate']['rate'];
									}
								});
						}
						for (ccy in $scope.frm_prices.ccy_list)
						{
							if ($scope.frm_prices.ccy_list[ccy].code == $scope.frm_prices.display_ccy)
							{
								$scope.frm_prices.display_ccy_symbol = $scope.frm_prices.ccy_list[ccy].symbol;
								if ($scope.frm_prices.display_ccy_symbol.length > 1)
								{
									$scope.frm_prices.display_ccy_symbol = $scope.frm_prices.display_ccy_symbol + ' ';
								}
							}
						}
					}
					if ($scope.frm_prices.display_fxrate == 0)
					{
						$scope.add_price_err = '';
						$scope.add_price_info = '';
						$scope.get_prices_info = '';
						$scope.price_stat_data = '';
						$scope.price_data = '';
						$scope.get_prices_err = 'No FX rate!'
					}
			    }

				$scope.upd_location_stats = function()
				{
					$scope.frm_prices.pub_country = $scope.home_country;
					$scope.upd_prices_pub_country();
					$scope.frm_prices.pub_city = $scope.home_city;
					$scope.upd_prices_pub_city();
					$scope.frm_prices.pub_town = $scope.home_town;
					$scope.upd_prices_pub_town();

					$scope.frm_pub.country = $scope.home_country;
					$scope.frm_pub.city = $scope.home_city;
					$scope.frm_pub.town = $scope.home_town;
					$scope.frm_pub.pc = $scope.home_pc;

					for (ctry in $scope.country_list)
					{
						if ($scope.country_list[ctry].name == $scope.home_country)
						{
							$scope.home_ccy = $scope.country_list[ctry].ccy;
						}
					}

					for (ccy in $scope.frm_prices.ccy_list)
					{
						if ($scope.frm_prices.ccy_list[ccy].code == $scope.home_ccy)
						{
							$scope.home_ccy_symbol = $scope.frm_prices.ccy_list[ccy].symbol;
							if ($scope.home_ccy_symbol.length > 1)
							{
								$scope.home_ccy_symbol = $scope.home_ccy_symbol + ' ';
							}
						}	
					}
					$scope.frm_prices.display_ccy = $scope.home_ccy;
					$scope.frm_prices.display_ccy_symbol = $scope.home_ccy_symbol;
					$scope.frm_prices.display_fxrate = 1

					$scope.working_head_stats = true;
					var stats = [];

					url = $scope.service_path + '/beerprice';
					$scope.http_get(url, 'page=1&pageSize=5&pubCountry=' + $scope.home_country, function(response)
						{
							$scope.head_stat_latest = response.data['beer-price'];
							$scope.working_head_stats = false
						}, function(response)
						{
							$scope.working_head_stats = false
						});

					console.log($scope.home_country+ ','+$scope.home_city+','+$scope.home_town+','+$scope.home_pc +','+ $scope.home_ccy_symbol +','+ $scope.home_ccy);

					var params = 'style=small';
					params = params + '&pubCountry=' + $scope.home_country;
					qry = 'BeerTypeAndPubTypeAndCountry'
					if ($scope.home_city.length > 0)
					{
						params = params + '&pubCity=' + $scope.home_city;
						qry = 'BeerTypeAndPubTypeAndCity'
					}
					params = params + '&pubType=Pub';
					if ($scope.home_town.length > 0)
					{
						params = params + '&pubTown=' + $scope.home_town;
						qry = 'BeerTypeAndPubTypeAndTown'
					}
					$scope.http_get($scope.service_path + '/beerpricestats/' + qry, params, function(response)
						{
							stats = response.data['beer-price-stats'];
							$scope.head_stat_avgs = '';
							$scope.head_stat_tot = 0;
							$scope.head_stat_tot2 = 0
							for (i = 0; i < stats.length; i++)
							{
								$scope.head_stat_tot = $scope.head_stat_tot + stats[i]['count'];
							}
							totyr = 0;
							minyr = ''
							for (i = 0; i < stats.length; i++)
							{
								totyr = totyr + stats[i]['recent-count'];
								if (minyr == '' || stats[i]['recent-min-date'] < minyr)
								{
									minyr = stats[i]['recent-min-date']
								}
							}
							$scope.head_stat_tot2 = totyr //' since ' + $scope.get_date_display(minyr);

							var frst = true;
							for (i = 0; i < stats.length; i++)
							{
								if (stats[i]['recent-avg-price'] > 0)
								{
									if (!frst)
									{	
										$scope.head_stat_avgs = $scope.head_stat_avgs + ', ';
									}
									else
									{
										$scope.head_stat_avgs = 'Revcently, ';
									}
									$scope.head_stat_avgs = $scope.head_stat_avgs + stats[i]['beer']['type'] + ' is ' + $scope.home_ccy_symbol + $scope.get_number_display(stats[i]['recent-avg-price'], 2);
									frst = false;
								}
							}
							if ($scope.head_stat_tot ==0)
							{
								$scope.head_stat_avgs = 'Be the first to record a pint price in a pub'
							}
							else if (totyr ==0)
							{
								$scope.head_stat_avgs = 'No recent pint prices in a pubs'
							}
						});
				}

				$scope.set_location = function(coords)
				{
					if (1 == 0)
					{
						$scope.home_country = 'Germany';
						$scope.home_city = 'Berlin';
						$scope.home_town = 'Berlin';
						$scope.home_pc = '';
						$scope.home_country = 'United Kingdom';
						$scope.home_city = 'ABC	';
						$scope.home_town = 'CDE';
						$scope.home_country = 'United Kingdom';
						$scope.home_city = 'Greater London';
						$scope.home_town = 'London';
						$scope.home_country = 'Netherlands';
						$scope.home_city = 'Government of Amsterdam';
						$scope.home_town = 'Amsterdam';
						$scope.upd_location_stats();
					}
					else
					{
						$http.get('https://maps.googleapis.com/maps/api/geocode/json?latlng=' + coords + '&key=AIzaSyDB-gk_9KWXlZ7eWj-SYToR8v5DTTI6T00').
							then(function(response)
							{
								$scope.home_country = '';
								$scope.home_city = '';
								$scope.home_town = '';
								$scope.home_pc = '';
								for (res in response.data.results)
								{
									for (add_comp in response.data.results[res]['address_components'])
									{
										address = response.data.results[res]['address_components'][add_comp];
										if (address['types'][0] == 'country')
											$scope.home_country = address['long_name'];
										else if (address['types'][0] == 'administrative_area_level_2')
											$scope.home_city = address['long_name'];
										else if (address['types'][0] == 'postal_town')
											$scope.home_town = address['long_name'];
										else if (address['types'][0] == 'locality')
											$scope.home_town = address['long_name'];
										else if (address['types'][0] == 'postal_code')
											$scope.home_pc = address['long_name'];
									}
								}
								if ($scope.home_city == '')
								{
									$scope.home_city = $scope.home_town;
								}
								$scope.upd_location_stats();
							}, 
							function(response) 
							{
							});
					}
				}

				$scope.login = function()
				{
					$scope.logginin = true;	
					$scope.token = '';
					url = $scope.service_path + '/authenticate';
					$scope.http_get(url, 'uid=' + $scope.user, function(resp)
						{
							$scope.token = resp.data.token 
							$scope.token_exp = resp.data.expiry 
							console.log('token is ' + $scope.token);
						
						
//						$http.get($scope.service_path + '/drinker/' + id + '?token=' + $scope.token).
//							then(function(response)
//							{
//								if (response.data.drinker !== undefined)	
//								{
//									$scope.user_type = response.data.drinker.type;
//									$scope.user_name = response.data.drinker.name;
//									console.log('howmuchisapint user name is ' + $scope.user_name);
//									console.log('howmuchisapint user type is ' + $scope.user_type);
//								}
//							}, 
//							function(response) 
//							{
//							});

							url = $scope.service_path + '/refdata/pubtype';
							$scope.http_get(url, '', function(response)
								{
									$scope.frm_prices.pub_type_list = [];
									$scope.frm_pub.type_list = [];
									for (p in response.data['ref-data-pub-type'])
									{
										pubtype = response.data['ref-data-pub-type'][p]
										$scope.frm_prices.pub_type_list.push(pubtype);
										$scope.frm_pub.type_list.push(pubtype);
									}
									$scope.frm_pub.type = 'Pub'
									$scope.upd_prices_pub_type();

								url = $scope.service_path + '/refdata/beertype';
								$scope.http_get(url, '', function(response)
									{
										$scope.frm_prices.beer_type_list = [];
										$scope.frm_beer.type_list = [];
										for (beertypei in response.data['ref-data-beer-type'])
										{
											beertype = response.data['ref-data-beer-type'][beertypei]
											$scope.frm_prices.beer_type_list.push(beertype);
											$scope.frm_beer.type_list.push(beertype);
										}
										$scope.frm_beer.type = 'Lager'
										$scope.upd_prices_beer_type();

										url = $scope.service_path + '/refdata/country';
										$scope.http_get(url, '', function(response)
											{
												$scope.country_list = response.data['ref-data-country'];

												url = $scope.service_path + '/refdata/ccy';
												$scope.http_get(url, '', function(response)
													{
														$scope.frm_prices.ccy_list = response.data['ref-data-ccy'];
														$scope.logginin = false;
														$scope.loggedin = true;
														$scope.upd_location_stats()
													});
											});
									});
								});
						});
				}
				$scope.login()

				$scope.agent_go = function()
			    {
					$scope.working_agent = true;
					$scope.agent_info = '';
					$scope.agent_err = '';
					$scope.http_post($scope.service_path + '/agent', {'command':$scope.frm_agent.command}, function(response)
						{
							$scope.beer_data = response.data;
							$scope.agent_info = response.data['response'];
							$scope.working_agent = false;
						}, 
						function(response) 
						{
							$scope.agent_err = $scope.service_message
							$scope.working_agent = false;
						}, 
						function(response) 
						{
							$scope.agent_err = $scope.service_message
							$scope.working_agent = false;
						});
			    }

				$scope.get_beers = function()
			    {
					$scope.working_add_beer = false;
					$scope.working_get_beers = true;
					$scope.beer_data = '';
					$scope.add_beer_info = '';
					$scope.add_beer_err = '';
					$scope.get_beers_info = '';
					$scope.get_beers_err = '';
					var params = 'style=small'
					if ($scope.frm_beer.type != null)
					{
						params = params + '&type=' + $scope.frm_beer.type;
					}
					if ($scope.frm_beer.name != null && $scope.frm_beer.name.length > 0)
					{
						params = params + '&name=' + $scope.frm_beer.name;
					}
					
					url = $scope.service_path + '/beer';
					$scope.http_get(url, params, function(response)
						{
							$scope.beer_data = response.data;
							$scope.get_beers_info = response.data['beer'].length + ' ' + $scope.frm_beer.type + 's';
							$scope.get_beers_info = $scope.get_beers_info + ' ' + ($scope.frm_beer.name != null && $scope.frm_beer.name.length > 0 ? ' named ' + $scope.frm_beer.name : '');
							$scope.working_get_beers = false;
						}, 
						function(response) 
						{
							$scope.get_beers_err = $scope.service_message
							$scope.working_get_beers = false;
						}, 
						function(response) 
						{
							$scope.get_beers_err = $scope.service_message
							$scope.working_get_beers = false;
						});
			    }
			    $scope.clear_pubs_sel = function()
			    {
					$scope.frm_pub.name = '';
					$scope.frm_pub.city = '';
					$scope.frm_pub.town = '';
					$scope.frm_pub.pc = '';
					$scope.pub_data = '';
					$scope.add_pub_info = '';
					$scope.get_pubs_info = '';
					$scope.add_pub_err = '';
					$scope.get_pubs_err = '';
				}
			    $scope.get_pubs = function()
			    {
					$scope.working_get_pubs = true;
					$scope.working_add_pub = false;
					$scope.pub_data = '';
					$scope.add_pub_info = '';
					$scope.get_pubs_info = '';
					$scope.add_pub_err = '';
					$scope.get_pubs_err = '';
					var params = 'style=small'
					if ($scope.frm_pub.town != null &&  $scope.frm_pub.town.length > 0)
					{
						params = params + '&town=' + $scope.frm_pub.town;
					}				
					if ($scope.frm_pub.city != null && $scope.frm_pub.city.length > 0)
					{
						params = params + '&city=' + $scope.frm_pub.city;
					}				
					if ($scope.frm_pub.country != null && $scope.frm_pub.country != null)
					{
						params = params + '&country=' + $scope.frm_pub.country;
					}				
					if ($scope.frm_pub.type != null && $scope.frm_pub.type != null)
					{
						params = params + '&type=' + $scope.frm_pub.type;
					}				
					if ($scope.frm_pub.name != null && $scope.frm_pub.name.length > 0)
					{
						params = params + '&name=' + $scope.frm_pub.name;
					}	
					
					url = $scope.service_path + '/pub';
					$scope.http_get(url, params, function(response)
						{
							$scope.pub_data = response.data;
							$scope.get_pubs_info = response.data['pub'].length + ' ' + $scope.frm_pub.type + 's';
							$scope.get_pubs_info = $scope.get_pubs_info + ' ' + ($scope.frm_pub.name != null && $scope.frm_pub.name.length > 0 ? ' named ' + $scope.frm_pub.name : '');
							$scope.get_pubs_info = $scope.get_pubs_info + ' in ' + ($scope.frm_pub.town != null && $scope.frm_pub.town.length > 0 ? $scope.frm_pub.town + ', ': '') + ($scope.frm_pub.city != null && $scope.frm_pub.city.length > 0 ? $scope.frm_pub.city + ', ' : '') + $scope.frm_pub.country;
							$scope.working_get_pubs = false;
						}, 
						function(response) 
						{
							$scope.get_pubs_err = $scope.service_message
							$scope.working_get_pubs = false;
						},
						function(response) 
						{
							$scope.get_pubs_err = $scope.service_message
							$scope.working_get_pubs = false;
						});
				}
			    $scope.clear_beers_sel = function()
			    {
					$scope.frm_beer.name = '';
					$scope.beer_data = '';
					$scope.add_beer_info = '';
					$scope.get_beers_info = '';
					$scope.add_beer_err = '';
					$scope.get_beers_err = '';
				}
			    $scope.get_prices_params = function() //wethers)
			    {
					var params = 'style=small'
					if ($scope.frm_prices.pub_town != null && $scope.frm_prices.pub_town.length > 0)
					{
						params = params + '&pubTown=' + $scope.frm_prices.pub_town;
					}				
					if ($scope.frm_prices.pub_city != null && $scope.frm_prices.pub_city.length > 0)
					{
						params = params + '&pubCity=' + $scope.frm_prices.pub_city;
					}				
					if ($scope.frm_prices.pub_country != null)
					{
						params = params + '&pubCountry=' + $scope.frm_prices.pub_country;
					}				
					if ($scope.frm_prices.pub_type != null && $scope.frm_prices.pub_type.length > 0)
					{
						params = params + '&pubType=' + $scope.frm_prices.pub_type;
					}				
					if ($scope.frm_prices.pub_name != null && $scope.frm_prices.pub_name.name.length > 0)
					{
						params = params + '&pubName=' + $scope.frm_prices.pub_name.name;
					}				
					if ($scope.frm_prices.beer_type != null && $scope.frm_prices.beer_type.length > 0)
					{
						params = params + '&beerType=' + $scope.frm_prices.beer_type;
					}	
					if ($scope.frm_prices.beer_name != null && $scope.frm_prices.beer_name.name.length > 0)
					{
						params = params + '&beerName=' + $scope.frm_prices.beer_name.name;
					}
					return params;
				}
			    $scope.get_avg_prices = function()
			    {
					$scope.get_prices_err = '';
					$scope.add_price_err = '';
					$scope.add_price_info = '';
					$scope.get_prices_info = '';
					$scope.price_stat_data = '';
					$scope.price_data = '';
					$scope.working_get_prices = true;
					$scope.working_add_price = false;
					var params = $scope.get_prices_params(true);

					url = $scope.service_path + '/beerpricestats/BeerTypeAndPubTypeAndCountry';
					$scope.http_get(url, params, function(response)
						{
							$scope.price_stat_data = response.data;
							var tot = 0;
							var yrtot = 0;
							for (p in response.data['beer-price-stats'])
							{
								tot = tot + response.data['beer-price-stats'][p].count;
								yrtot = yrtot + response.data['beer-price-stats'][p]['recent-count'];
							}
							$scope.get_prices_info = $scope.get_number_display(response.data['beer-price-stats'].length, 0) + ' summaries from ' + $scope.get_number_display(tot, 0) + ' prices (' + $scope.get_number_display(yrtot, 0) + ' recent) ' + $scope.prices_criteria();
							$scope.working_get_prices = false;
						}, 
						function(response) 
						{
							$scope.get_prices_err = $scope.service_message
							$scope.working_get_prices = false;
						},
						function(response) 
						{
							$scope.get_prices_err = $scope.service_message
							$scope.working_get_prices = false;
						});
			    }
			    $scope.get_prices = function()
			    {
					$scope.get_prices_err = '';
					$scope.add_price_info = '';
					$scope.get_prices_info = '';
					$scope.price_stat_data = '';
					$scope.price_data = '';
					$scope.working_get_prices = true;
					$scope.working_add_price = false;
					var params = $scope.get_prices_params();
					
					url = $scope.service_path + '/beerprice';
					$scope.http_get(url, params, function(response)
						{
							$scope.price_data = response.data;
							$scope.get_prices_info = $scope.get_number_display(response.data['beer-price'].length, 0)  + ' prices ' + $scope.prices_criteria();
							$scope.working_get_prices = false;
						}, 
						function(response) 
						{
							$scope.get_prices_err = $scope.service_message
							$scope.working_get_prices = false;
						},
						function(response) 
						{
							$scope.get_prices_err = $scope.service_message
							$scope.working_get_prices = false;
						});
			    }
			    $scope.clear_prices_sel = function()
			    {
					$scope.frm_prices.beer_type = '';
					$scope.upd_prices_beer_type();
					
					$scope.frm_prices.pub_city = '';
					$scope.upd_prices_pub_city();

					$scope.get_prices_err = '';
					$scope.add_price_err = '';
					$scope.add_price_info = '';
					$scope.get_prices_info = '';
					$scope.price_stat_data = '';
					$scope.price_data = '';
				}
			    $scope.prices_criteria = function()
			    {
					var criteria = ' '
					if ($scope.frm_prices.beer_name != null && $scope.frm_prices.beer_name.name.length > 0)
					{
						criteria = criteria + ' for ' + $scope.frm_prices.beer_name.name + ' ';
					}
					else if ($scope.frm_prices.beer_type != null && $scope.frm_prices.beer_type.length > 0)
					{
						criteria = criteria + ' for ' + $scope.frm_prices.beer_type + ' ';
					}
					criteria = criteria + ' in ' 
					if ($scope.frm_prices.pub_name != null && $scope.frm_prices.pub_name.name.length > 0)
					{
						criteria = criteria + $scope.frm_prices.pub_name.name + ' in ';
					}
					else if ($scope.frm_prices.pub_type != null && $scope.frm_prices.pub_type.length > 0)
					{
						criteria = criteria + $scope.frm_prices.pub_type + 's in '
					}
					criteria = criteria +  ($scope.frm_prices.pub_town != null && $scope.frm_prices.pub_town.length > 0 ? $scope.frm_prices.pub_town + ', ': '') + ($scope.frm_prices.pub_city != null && $scope.frm_prices.pub_city.length > 0 ? $scope.frm_prices.pub_city + ', ' : '') + $scope.frm_prices.pub_country
					return criteria;
			    }
			    $scope.add_beer = function()
			    {
					$scope.beer_data = '';
					$scope.add_beer_err = '';
					$scope.get_beers_err = '';
					$scope.add_beer_info = '';
					$scope.get_beers_info = '';
					$scope.working_get_beers = false;
			    	if ($scope.frm_beer.type.length == 0 || $scope.frm_beer.name == null || $scope.frm_beer.name.length == 0)	
			    	{
						$scope.add_beer_err = 'Beer type and name required';
			    	}
			    	else
			    	{
						$scope.working_add_beer = true;
			    		msg = {"beer":{"type":$scope.frm_beer.type,"name":$scope.frm_beer.name}};
						url = $scope.service_path + '/beer';
						$scope.http_post(url, msg, function(response)
							{
								$scope.add_beer_info = response.data.beer.type + ' ' + response.data.beer.name

								$scope.frm_beer.name = '';

								$scope.frm_prices.beer_type = response.data.beer.type;
								$scope.upd_prices_beer_type();
								$scope.frm_prices.beer_name = response.data.beer;
								$scope.add_beer_err = response.statusText;
								$scope.working_add_beer = false;
							}, 
							function(response) 
							{
								$scope.add_beer_err = $scope.service_message
								$scope.working_add_beer = false;
							}, 
							function(response) 
							{
								$scope.add_beer_err = $scope.service_message
								$scope.working_add_beer = false;
							});
					}
			    }
			    $scope.add_pub = function()
			    {
					$scope.pub_data = '';
					$scope.add_pub_err = '';
					$scope.get_pubs_err = '';
					$scope.add_pub_info = '';
					$scope.get_pubs_info = '';
					$scope.working_get_pubs = false;
			    	if ($scope.frm_pub.type.length == 0 || $scope.frm_pub.name.length == 0 || $scope.frm_pub.country.length == 0 || $scope.frm_pub.town.length == 0 || $scope.frm_pub.city.length == 0 || $scope.frm_pub.pc.length == 0)	
			    	{
						$scope.add_pub_err = 'Pub type, name, country, city, town and post-code required';
			    	}
			    	else
			    	{
						$scope.working_add_pub = true;
			    		msg = {"pub":{"type":$scope.frm_pub.type,"name": $scope.frm_pub.name ,"country": $scope.frm_pub.country,"city": $scope.frm_pub.city,"town":$scope.frm_pub.town,"post-code":$scope.frm_pub.pc}};
						url = $scope.service_path + '/pub';
						$scope.http_post(url, msg, function(response)
							{
								$scope.add_pub_info = response.data.pub.type + ' ' + response.data.pub.name + ' in ' + response.data.pub.town + ', ' + response.data.pub.city + ', ' + response.data.pub.country

								$scope.frm_pub.name = '';

								$scope.frm_prices.pub_country = response.data.pub.country;
								$scope.upd_prices_pub_country();
								$scope.frm_prices.pub_city = response.data.pub.city;
								$scope.upd_prices_pub_city();
								$scope.frm_prices.pub_town = response.data.pub.town;
								$scope.upd_prices_pub_town();
								$scope.frm_prices.pub_type = response.data.pub.type;
								$scope.upd_prices_pub_type();
								$scope.frm_prices.pub_name = response.data.pub;
								$scope.add_pub_err = response.statusText;
								$scope.working_add_pub = false;
							}, 
							function(response) 
							{
								$scope.add_pub_err = $scope.service_message
								$scope.working_add_pub = false;
							}, 
							function(response) 
							{
								$scope.add_pub_err = $scope.service_message
								$scope.working_add_pub = false;
							});
					}
			    }
			    $scope.add_price = function()
			    {
					$scope.add_price_err = '';
					$scope.get_prices_err = '';
					$scope.add_price_info = '';
					$scope.get_prices_info = '';
					$scope.price_stat_data = '';
					$scope.price_data = '';
					$scope.working_get_prices = false;
			    	if ($scope.frm_prices.amount == 0 || $scope.frm_prices.pub_name == null || $scope.frm_prices.beer_name == null)	
			    	{
						$scope.add_price_err = 'Pub, beer and price required';
			    	}
			    	else
			    	{
						$scope.working_add_price = true;
					    today = new Date();
					    date = today.getFullYear() + (today.getMonth()>8 ? '' : '0') + (today.getMonth() + 1) + (today.getDate()>9 ? '' : '0') + today.getDate();
			    		msg = {"beer-price":{"date":date,"price":$scope.frm_prices.amount,"pub-id":$scope.frm_prices.pub_name.id,"beer-id":$scope.frm_prices.beer_name.id }};
						url = $scope.service_path + '/beerprice';
						$scope.http_post(url, msg, function(response)
							{
								price = response.data['beer-price']
								ccy_symbol  = ''
								for (ccy in $scope.frm_prices.ccy_list)
								{
									if ($scope.frm_prices.ccy_list[ccy].code == $scope.frm_prices.ccy)
									{
										ccy_symbol = $scope.frm_prices.ccy_list[ccy].symbol;
									}
								}

								$scope.add_price_info = price.beer.name + ' at ' + price.pub.name + ' is ' + ccy_symbol + $scope.get_number_display(price.price, 2);

								$scope.frm_prices.amount = 0.00;
								$scope.add_price_err = '';
								$scope.working_add_price = false;
							}, 
							function(response) 
							{
								$scope.add_price_err = $scope.service_message
								$scope.working_add_price = false;
							}, 
							function(response) 
							{
								$scope.add_price_err = $scope.service_message
								$scope.working_add_price = false;
							});
			    	}
			    }
				$scope.get_years_ago_display = function(year)
				{
					ago = new Date().getFullYear() - year
					if (ago == 0)
					{
						return ' this year';
					}
					else if (ago == 1)
					{
						return ' last year';				
					}
					else
					{
						return ago + ' years ago';				
					}
				}
				$scope.get_date_display = function(dt)
				{
					var mlist = [ "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec" ];
					var str = dt.substring(6,8) + '-' + mlist[parseInt(dt.substring(4,6))-1] + '-' + dt.substring(0,4) 
					if (dt.substring(8,10).length>0)
					{
						str = str + ' ' + dt.substring(8,10) + ':' + dt.substring(10,12) + ' ' + dt.substring(12);
					}
					return str;
				}
				$scope.get_time_display = function(tm)
				{
					if (parseInt(tm) == 0)
					{
						str = "";
					}
					else
					{
						var str = tm.substring(5,7) + ':' + tm.substring(7,9);
						if (parseInt(tm.substring(0,5)) > 0)
						{
							str = tm.substring(0,5) + ':' + str;
							if (parseInt(str.substring(0,1)) == 0)
							{
								str = str.substring(1);
								if (parseInt(str.substring(0,1)) == 0)
								{
									str = str.substring(1);
									if (parseInt(str.substring(0,1)) == 0)
									{
										str = str.substring(1);
										if (parseInt(str.substring(0,1)) == 0)
										{
											str = str.substring(1);
										}
									}
								}
							}
						}
					}
					return str;
				}
				$scope.get_list_display = function(lst)
				{
					var str = "";
					for (i = 0; i < lst.length; i++)
					{
						str = str + lst[i] + " ";
					}
					return str.substring(0, str.length);
				}
				$scope.get_date_list_display = function(dts)
				{
					var str = "";
					for (i = 0; i < dts.length; i++)
					{
						str = str + $scope.get_date_display(dts[i]) + " ";
					}
					return str.substring(0, str.length);
				}
				$scope.get_number_display = function(num, dp)
				{
					if (num == null)
					{
						return "";
					}
					else
					{	
						return num.toFixed(dp).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
					}
				}
				$scope.get_number_list_display = function(nums, dp)
				{
					var str = "";
					for (i = 0; i < nums.length; i++)
					{
						str = str + $scope.get_number_display(nums[i],2) + " ";
					}
					return str.substring(0, str.length);
				}
				$scope.get_percent_display = function(num, dp)
				{
					if (num == null)
					{
						return "";
					}
					else
					{	
						num2 = num * 100;
						return num2.toFixed(dp).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
					}
				}
			});
	        navigator.geolocation.getCurrentPosition(showPosition);
			function showPosition(position) 
			{
				var coords = position.coords.latitude + ',' + position.coords.longitude;
			    console.log('coords=' + coords)
				setTimeout(() => {
				  angular.element(document.querySelector('[ng-controller="appCtrl"]'))
					.scope()
					.set_location(coords);
				}, 500);
			}
			
		</script>
	</body>
</html>